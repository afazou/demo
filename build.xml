<?xml version="1.0" encoding="UTF-8"?>
<project name="phpmd.example" default="prepare" basedir=".">
    <target name="prepare"
            unless="prepare.done"
            description="Prepare for build">
        <mkdir dir="${basedir}/build/api"/>
        <mkdir dir="${basedir}/build/coverage"/>
        <mkdir dir="${basedir}/build/logs"/>
        <mkdir dir="${basedir}/build/pdepend"/>
        <mkdir dir="${basedir}/build/phpdox"/>
        <property name="prepare.done" value="true"/>
    </target>

    <target name="phpunit"
            unless="phpunit.done"
            depends="prepare"
            description="Run unit tests with PHPUnit">
        <!--failonerror：当出现错误时自动停止-->
        <exec executable="/usr/local/bin/phpunit" failonerror="true">
            <arg value="--configuration"/>
            <arg value="${basedir}/phpunit.xml"/>
            <arg value="--coverage-html"/>
            <arg value="${basedir}/build/coverage"/>
            <arg value="--coverage-clover"/>
            <arg value="${basedir}/build/coverage/coverage.xml"/>
        </exec>

        <property name="phpunit.done" value="true"/>
    </target>

</project>


